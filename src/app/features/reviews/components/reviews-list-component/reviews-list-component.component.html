<div *ngIf="reviews.length > 0">
  <div class="review-container">
    <div *ngFor="let review of reviews; track: index">
      <div *ngIf="review.idEntrepreneurship === id">
        <div class="review-item">
          <!-- Mostrar la reseña solo si no estamos editando -->
          <div *ngIf="!isEditing || editingReview?.id !== review.id">
            <h4 class="reviewer-name">Usuario: {{ review.username }}</h4>
            <div class="review-stars">
              <p class="rating-text">Calificación: {{ review.stars }} / 5</p>
              <div class="star-rating">
                <ng-container *ngFor="let star of [1, 2, 3, 4, 5]; let i = index">
                  <i class="fa fa-star" [ngClass]="{'checked': i < review.stars}"></i>
                </ng-container>
              </div>
            </div>
            <p class="review-description">Texto: {{ review.reviewText || 'No disponible' }}</p>

            <!-- Mostrar botones solo si la reseña es del usuario activo -->
            <div *ngIf="review.idUser === activeUser?.id">
              <button (click)="deleteReview(review.id)">Eliminar review</button>
              <button (click)="modifyReview(review)">Modificar Review</button>
            </div>
          </div>
          <!-- Formulario para modificar la reseña -->
          <div *ngIf="isEditing && editingReview?.id === review.id">
            <form [formGroup]="reviewUpdateForm" (ngSubmit)="updateReview()">
              <label for="stars">
                Calificación:
                <div class="star-rating">
                  <ng-container *ngFor="let star of [1, 2, 3, 4, 5]; let i = index">
                    <i
                      class="fa fa-star"
                      [ngClass]="{'checked': i < reviewUpdateForm.get('stars')?.value}"
                      (click)="setRating(i + 1)">
                    </i>
                  </ng-container>
                </div>
                <div *ngIf="reviewUpdateForm.get('stars')?.invalid && reviewUpdateForm.get('stars')?.touched">
                  La calificación debe estar entre 1 y 5.
                </div>
              </label>

              <label for="reviewText">
                Comentario:
                <textarea formControlName="reviewText" id="reviewText"></textarea>
                <div *ngIf="reviewUpdateForm.get('reviewText')?.invalid && reviewUpdateForm.get('reviewText')?.touched">
                  El comentario es obligatorio.
                </div>
              </label>
              <button type="submit" [disabled]="reviewUpdateForm.invalid">Actualizar</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="reviews.length === 0">
  <p class="no-reviews">No hay reseñas disponibles.</p>
</div>
